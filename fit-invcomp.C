{
 gROOT->Reset();

 c1=new TCanvas ("c1", "",20,1,640,480);
 TMultiGraph *mg = new TMultiGraph();
 mg->SetTitle(";E(eV); E^{2}dN/dE (MeV cm^{-2} s^{-1})");
 c1->SetFillColor(10);
 c1->GetFrame()->SetFillColor(25);
 c1->GetFrame()->SetBorderSize(20);



 Int_t n2=14;//FERMI
 Int_t i;
 //The last four data points were taken from the "butterfly boxes".
 Float_t w2[n2]={
 10**(22.5484948112-14.25),
 10**(23.2629292108-14.25),
 10**(23.8820864758-14.25),
 10**(24.6387748604-14.25),
 10**(25.3777409573-14.25),
 10**(25.765957446-14.25),
 10**(25.819148936-14.25),
 10**(25.914893617-14.25),
 10**(26.031914893-14.25),
 10**(26.148936170-14.25),
 10**(26.287234042-14.25),
 10**(26.404255319-14.25),
 10**(26.563829787-14.25),
 10**(26.776595744-14.25)
 };//x

 Float_t v2[n2]={
 10**(-10.8266451888),
 10**(-10.7344346435),
 10**(-10.5523629359),
 10**(-10.5652650171),
 10**(-10.7344346435),
 10**(-10.9333333333),
 10**(-11.2333333333),
 10**(-11.6000000000),
 10**(-11.4000000000),
 10**(-11.7333333333),
 10**(-12.3000000000),
 10**(-12.6333333333),
 10**(-12.9333333333),
 10**(-12.0666666667)
 };

 Float_t ewh2[n2]={
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001
 };
 Float_t ewl2[n2]={
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001,
 0.0000000000000000001
 };
                                              
 Float_t evl2[n2]={
 10**(-13.8199903955),
 10**(-13.1917666682),
 10**(-11.8199903955),
 10**(-11.1917666682),
 10**(-10.9104215364),
 10**(-11.2042972981),
 10**(-11.5042972981),
 10**(-12.0329234333),
 10**(-12.2467825827),
 10**(-12.5801159161),
 10**(-12.4997604315),
 10**(-12.7148483952),
 10**(-12.9829575323),
 10**(-12.0730884837)
};
                                              
 Float_t evh2[n2]={
 10**(-13.8199903955),
 10**(-13.1917666682),
 10**(-11.4994281342),
 10**(-11.0699662699),
 10**(-10.8657492269),
 10**(-11.005014412),
 10**(-11.820158657),
 10**(-12.186825324),
 10**(-12.498132303),
 10**(-12.831465636),
 10**(-12.371681079),
 10**(-12.453814163),
 10**(-12.598421872),
 10**(-12.511141293)
};
                                              
gr2=new TGraphAsymmErrors(n2,w2,v2,ewl2,ewh2,evl2,evh2);
 gr2->SetMarkerColor(1);
 gr2->SetMarkerStyle(4);
 gr2->SetMarkerSize(0.7);  
 gr2->SetLineColor(0); 
 gr2->SetLineStyle(1); 
 gPad->SetLogy();  
 gPad->SetLogx();





  //Int_t n4=3;//Magic
  //Int_t i;
  //Float_t w4[n4]={1e11, 1.9e11, 3.8e11};//x
  //Float_t v4[n4]={3.8e-6,6.8e-7,3.7e-7};//y
  //Float_t ewl4[n4]={0,0,0};
  //Float_t evl4[n4]={1.0e-6,4.8e-7,3.1e-7};
  //Float_t ewh4[n4]={0,0,0};
  //Float_t evh4[n4]={1.8e-6,4.8e-7,3.1e-7};
  //gr4=new TGraphAsymmErrors(n4,w4,v4,ewl4,ewh4,evl4,evh4);
  //gr4->SetMarkerColor();
  //gr4->SetMarkerStyle(8);
  //gr4->SetMarkerSize(0.7);
  //gr4->SetLineColor(1);
  //gPad->SetLogy();
  //gPad->SetLogx();



 Int_t n20=2;//end
 Int_t i;
 Float_t w20[n20]={9.484e14,1.796e13};
 Float_t v20[n20]={1.435e-9,1.996e-9};
 Float_t ewl20[n20]={0,0};
 Float_t evl20[n20]={0,0};
 Float_t ewh20[n20]={0,0};
 Float_t evh20[n20]={0,0};
 gr20=new TGraphAsymmErrors(n20,w20,v20,ewl20,ewh20,evl20,evh20);
 gr20->SetMarkerColor();
 gr20->SetMarkerStyle(8);
 gr20->SetMarkerSize(0.0001);  
 gr20->SetLineColor(3);
 gPad->SetLogy();  
 gPad->SetLogx();
 gr20->SetFillColor(2); 

 Int_t n21=2;//beginning
 Int_t i;
 Float_t w21[n21]={2.484e-9,5.796e-9};
 Float_t v21[n21]={1.435e-9,1.996e-9};
 Float_t ewl21[n21]={0,0};
 Float_t evl21[n21]={0,0};
 Float_t ewh21[n21]={0,0};
 Float_t evh21[n21]={0,0};
 gr21=new TGraphAsymmErrors(n21,w21,v21,ewl21,ewh21,evl21,evh21);
 gr21->SetMarkerColor();
 gr21->SetMarkerStyle(8);
 gr21->SetMarkerSize(0.0001);  
 gr21->SetLineColor(3);
 gPad->SetLogy();  
 gPad->SetLogx();
 gr21->SetFillColor(2); 






 mg->Add(gr2);
 mg->Add(gr20);
 mg->Add(gr21);
 
 mg->Draw("apz");




//############################Fit formulas###############
//################
//##############################################################
//

 fun4 = new TF1("fun4","[0]*((x/[1])^(4/3)*(x>1e3)*(x<[1])+((x/[1])**((3-[3])/2)*(x>=[1])*(x<[2])) + (([2]/[1])**((3-[3])/2))*((x/[2])**((2-[3])/2))*(x>=[2])*(x<3e14) )",1e+3,3e+14); //pgamma interaction
 // Se fija el valor inicial de las energías de normalización:
  fun4->SetParameter(0,6.32041e-13);
  //fun4->SetParLimits(0,1e+5,1e+7);
  fun4->SetParameter(1,5e9);
  fun4->SetParLimits(1,1e+6,1e+11);
  fun4->SetParameter(2,1e+11);
  fun4->SetParLimits(2,1e+10,1e+13);
  fun4->SetParameter(3,2.588);
  fun4->SetParLimits(3,2.588,2.588);
 
//#################fit commands############
//####################################
//
//
//

 fun4->SetLineWidth(2);
 gr2->Fit("fun4","APL+"); 
 //gr4->Fit("fun3","APL+"); 
 }


