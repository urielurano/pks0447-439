
{
 gROOT->Reset();

 c1=new TCanvas ("c1", "",20,1,640,480);
 TMultiGraph *mg = new TMultiGraph();
 mg->SetTitle(";E(eV); E^{2}dN/dE (MeV cm^{-2} s^{-1})");
 c1->SetFillColor(10);
 c1->GetFrame()->SetFillColor(25);
 c1->GetFrame()->SetBorderSize(20);
 

 Int_t n=23;//unkonwn
 Int_t i;
 Float_t w[n]={
 10**(9.02959140514534-14.25),
 10**(9.46647032706642-14.25),
 10**(9.68501613341494-14.25),
 10**(9.68372947345189-14.25),
 10**(9.91487980603938-14.25),
 10**(9.67002700158961-14.25),
 10**(10.2631786540023-14.25),
 10**(14.4918287795526-14.25),
 10**(14.6555957864971-14.25),
 10**(14.6876428975851-14.25),
 10**(14.9898861427620-14.25),
 10**(14.9206172041999-14.25),
 10**(14.8888453968166-14.25),
 10**(16.9515370457320-14.25),
 10**(17.2216944560895-14.25),
 10**(17.3203058366255-14.25),
 10**(17.3927248978858-14.25),
 10**(17.4807953221140-14.25),
 10**(17.5808903135782-14.25),
 10**(17.7243221474798-14.25),
 10**(17.9239455502187-14.25),
 10**(18.1138797533583-14.25),
 10**(18.3864035716809-14.25)
 
 };//x

 Float_t v[n]={
 10**(-14.50842175612880),
 10**(-14.25935621305773),
 10**(-14.21527854915099),
 10**(-14.14718984713895),
 10**(-14.00752221268428),
 10**(-13.91323210343243),
 10**(-13.61185742597514),
 10**(-10.34952979288029),
 10**(-10.31517708740258),
 10**(-10.28093840723783),
 10**(-10.28093840723783),
 10**(-10.23546355241396),
 10**(-10.29233865453564),
 10**(-10.83893099473004),
 10**(-10.85663840606620),
 10**(-10.94448461964206),
 10**(-10.89870105485416),
 10**(-10.96291004854542),
 10**(-10.97684962565035),
 10**(-11.02435129821701),
 10**(-11.12283184769367),
 10**(-11.09033077551279),
 10**(-11.34699684178016)
 
 
 };//y,

 Float_t ewl[n]={
 10**(8.02959140514534-14.25),
 10**(8.46647032706642-14.25),
 10**(8.68501613341494-14.25),
 10**(8.68372947345189-14.25),
 10**(8.91487980603938-14.25),
 10**(8.67002700158961-14.25),
 10**(9.2631786540023-14.25),
 10**(13.4918287795526-14.25),
 10**(13.6555957864971-14.25),
 10**(13.6876428975851-14.25),
 10**(13.9898861427620-14.25),
 10**(13.9206172041999-14.25),
 10**(13.8888453968166-14.25),
 10**(15.9515370457320-14.25),
 10**(16.2216944560895-14.25),
 10**(16.3203058366255-14.25),
 10**(16.3927248978858-14.25),
 10**(16.4807953221140-14.25),
 10**(16.5808903135782-14.25),
 10**(16.7243221474798-14.25),
 10**(16.9239455502187-14.25),
 10**(17.1138797533583-14.25),
 10**(17.3864035716809-14.25)
 
 };//ex

 Float_t evl[n]={
 10**(-15.50842175612880),
 10**(-15.25935621305773),
 10**(-15.21527854915099),
 10**(-15.14718984713895),
 10**(-15.00752221268428),
 10**(-14.91323210343243),
 10**(-14.61185742597514),
 10**(-11.34952979288029),
 10**(-11.31517708740258),
 10**(-11.28093840723783),
 10**(-11.28093840723783),
 10**(-11.23546355241396),
 10**(-11.29233865453564),
 10**(-11.83893099473004),
 10**(-11.85663840606620),
 10**(-11.94448461964206),
 10**(-11.89870105485416),
 10**(-11.96291004854542),
 10**(-11.97684962565035),
 10**(-12.02435129821701),
 10**(-12.12283184769367),
 10**(-12.09033077551279),
 10**(-12.34699684178016)
 
 
 };//ey,

 Float_t ewh[n]={
 10**(8.02959140514534-14.25),
 10**(8.46647032706642-14.25),
 10**(8.68501613341494-14.25),
 10**(8.68372947345189-14.25),
 10**(8.91487980603938-14.25),
 10**(8.67002700158961-14.25),
 10**(9.2631786540023-14.25),
 10**(13.4918287795526-14.25),
 10**(13.6555957864971-14.25),
 10**(13.6876428975851-14.25),
 10**(13.9898861427620-14.25),
 10**(13.9206172041999-14.25),
 10**(13.8888453968166-14.25),
 10**(15.9515370457320-14.25),
 10**(16.2216944560895-14.25),
 10**(16.3203058366255-14.25),
 10**(16.3927248978858-14.25),
 10**(16.4807953221140-14.25),
 10**(16.5808903135782-14.25),
 10**(16.7243221474798-14.25),
 10**(16.9239455502187-14.25),
 10**(17.1138797533583-14.25),
 10**(17.3864035716809-14.25)
 
 };//ex

 Float_t evh[n]={
 10**(-15.50842175612880),
 10**(-15.25935621305773),
 10**(-15.21527854915099),
 10**(-15.14718984713895),
 10**(-15.00752221268428),
 10**(-14.91323210343243),
 10**(-14.61185742597514),
 10**(-11.34952979288029),
 10**(-11.31517708740258),
 10**(-11.28093840723783),
 10**(-11.28093840723783),
 10**(-11.23546355241396),
 10**(-11.29233865453564),
 10**(-11.83893099473004),
 10**(-11.85663840606620),
 10**(-11.94448461964206),
 10**(-11.89870105485416),
 10**(-11.96291004854542),
 10**(-11.97684962565035),
 10**(-12.02435129821701),
 10**(-12.12283184769367),
 10**(-12.09033077551279),
 10**(-12.34699684178016)
 
 
 };//ey,



 gr=new TGraphAsymmErrors(n,w,v,ewl,ewh,evl,evh);
 gr->SetMarkerColor();
 gr->SetMarkerStyle(8);
 gr->SetMarkerSize(0.7);
 gr->SetLineColor(1);
 gPad->SetLogy();
 gPad->SetLogx();
 
 gr->SetLineStyle(1);  
 gPad->SetLogy();  
 gPad->SetLogx();


 




 
 Int_t n20=2;//end
 Int_t i;
 Float_t w20[n20]={9.484e13,1.796e13};
 Float_t v20[n20]={1.435e-9,1.996e-9};
 Float_t ewl20[n20]={0,0};
 Float_t evl20[n20]={0,0};
 Float_t ewh20[n20]={0,0};
 Float_t evh20[n20]={0,0};
 gr20=new TGraphAsymmErrors(n20,w20,v20,ewl20,ewh20,evl20,evh20);
 gr20->SetMarkerColor();
 gr20->SetMarkerStyle(8);
 gr20->SetMarkerSize(0.0001);  
 gr20->SetLineColor(3);
 gPad->SetLogy();  
 gPad->SetLogx();
 gr20->SetFillColor(2); 

 Int_t n21=2;//beginning
 Int_t i;
 Float_t w21[n21]={2.484e-9,5.796e-9};
 Float_t v21[n21]={1.435e-9,1.996e-9};
 Float_t ewl21[n21]={0,0};
 Float_t evl21[n21]={0,0};
 Float_t ewh21[n21]={0,0};
 Float_t evh21[n21]={0,0};
 gr21=new TGraphAsymmErrors(n21,w21,v21,ewl21,ewh21,evl21,evh21);
 gr21->SetMarkerColor();
 gr21->SetMarkerStyle(8);
 gr21->SetMarkerSize(0.0001);  
 gr21->SetLineColor(3);
 gPad->SetLogy();  
 gPad->SetLogx();
 gr21->SetFillColor(2); 






  mg->Add(gr);
 
  mg->Add(gr20);
 mg->Add(gr21);
 
 mg->Draw("apz");




//############################Fit formulas###############
//################
//##############################################################
//
fun4 = new TF1("fun4","[0]*((x/[2])^(4/3)*(x>1e-7)*(x<[2])+((x/[2])**((3-[1])/2)*(x>=[2])*(x<[3])) + (([3]/[2])**((3-[1])/2))*((x/[3])**((2-[1])/2))*(x>=[3])*(x<5e5))",  1e-7,5e5); //pgamma interaction
// Se fija el valor inicial de las energías de normalización:
fun4->SetParameter(0,1e-13);
fun4->SetParLimits(0,1e-20,1e-5);
fun4->SetParameter(1,2.6);
fun4->SetParLimits(1,2,3);
fun4->SetParameter(2,5);
fun4->SetParLimits(2,1e-3,1e2);
fun4->SetParameter(3,5);
fun4->SetParLimits(3,1e-1,1e5);
// fun3 = new TF1("fun3","[0]*(x/1e12)^(2-[1])",1e+11,1e+13); //pp interaction
 //
////#################fit commands############
////####################################
////###############
////
////
////((1e-1/1)^(-0.5)*(x/1)^(4/3)*(1e-4/1)**((3-[1])/2)*(x>1e-6)*(x<1e-4))
//
 fun4->SetLineWidth(2);
  gr->Fit("fun4","APL+"); 
 //// gr4->Fit("fun3","APL+"); 
 }


